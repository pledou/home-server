# OpenSSH Server Configuration
# Generated by Ansible - DO NOT EDIT MANUALLY
# Managed by: playbooks/roles/security

# Basic Configuration
Port {{ ssh_port }}
Protocol {{ ssh_protocol }}
AddressFamily any

# Logging
SyslogFacility AUTH
LogLevel {{ ssh_log_level }}

# Authentication
PermitRootLogin {{ ssh_permit_root_login }}
PubkeyAuthentication {{ ssh_pubkey_authentication }}
PasswordAuthentication {{ ssh_password_authentication }}
PermitEmptyPasswords {{ ssh_permit_empty_passwords }}
ChallengeResponseAuthentication {{ ssh_challenge_response_authentication }}

# Kerberos and GSSAPI
KerberosAuthentication no
GSSAPIAuthentication no

# PAM
UsePAM {{ ssh_use_pam }}

# Security Options
StrictModes {{ ssh_strict_modes }}
IgnoreRhosts {{ ssh_ignore_rhosts }}
HostbasedAuthentication {{ ssh_hostbased_authentication }}
PermitUserEnvironment {{ ssh_permit_user_environment }}

# Connection Settings
MaxAuthTries {{ ssh_max_auth_tries }}
MaxSessions {{ ssh_max_sessions }}
ClientAliveInterval {{ ssh_client_alive_interval }}
ClientAliveCountMax {{ ssh_client_alive_count_max }}
TCPKeepAlive yes

# Forwarding
X11Forwarding {{ ssh_x11_forwarding }}
AllowAgentForwarding yes
AllowTcpForwarding yes
PermitTunnel no

# Other
Compression {{ ssh_compression }}
PrintMotd no
PrintLastLog yes
AcceptEnv LANG LC_*

# Access Control
{% if ssh_allow_users %}
AllowUsers {{ ssh_allow_users }}
{% endif %}
{% if ssh_allow_groups %}
AllowGroups {{ ssh_allow_groups }}
{% endif %}
{% if ssh_deny_users %}
DenyUsers {{ ssh_deny_users }}
{% endif %}
{% if ssh_deny_groups %}
DenyGroups {{ ssh_deny_groups }}
{% endif %}

# Cryptographic Algorithms
PubkeyAcceptedKeyTypes {{ ssh_pubkey_accepted_key_types }}
HostKeyAlgorithms {{ ssh_host_key_algorithms }}
Ciphers {{ ssh_ciphers }}
MACs {{ ssh_macs }}
KexAlgorithms {{ ssh_kex_algorithms }}

# Host Keys
HostKey /etc/ssh/ssh_host_rsa_key
HostKey /etc/ssh/ssh_host_ecdsa_key
HostKey /etc/ssh/ssh_host_ed25519_key

# Subsystem
Subsystem sftp /usr/lib/openssh/sftp-server

# Banner
#Banner /etc/ssh/banner
